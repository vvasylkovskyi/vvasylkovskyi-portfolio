(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[286],{4830:(e,t,n)=>{"use strict";n.d(t,{U:()=>s,V:()=>o});var r=n(9964);let s=r.Ay.div.withConfig({componentId:"sc-5e4ae5b2-0"})(["position:relative;width:100%;"]),o=r.Ay.div.withConfig({componentId:"sc-5e4ae5b2-1"})(["position:relative;display:flex;max-width:992px;width:100%;"])},7119:(e,t,n)=>{Promise.resolve().then(n.bind(n,9496))},9496:(e,t,n)=>{"use strict";let r;n.r(t),n.d(t,{default:()=>h});var s=n(3629);let o=e=>{let{message:t}=e;return(0,s.jsx)("div",{className:"flex w-max max-w-[75%] flex-col gap-2 rounded-lg px-3 py-2 text-sm ml-auto ai-message",children:t})},l=e=>{let{isDisabled:t,onClick:n,text:r}=e;return(0,s.jsxs)("button",{className:"chat-send-button inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-9 w-9",disabled:t,onClick:n,children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",className:"lucide lucide-send",children:[(0,s.jsx)("path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}),(0,s.jsx)("path",{d:"m21.854 2.147-10.94 10.939"})]}),(0,s.jsx)("span",{className:"sr-only",children:r})]})},i=e=>{let{onClick:t,handleChange:n,handleKeyDown:r,input:o}=e;return(0,s.jsxs)("form",{className:"flex w-full items-center space-x-2",children:[(0,s.jsx)("input",{className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm flex-1",id:"message",placeholder:"Type or paste your message...",autoComplete:"off",value:o,onChange:n,onKeyDown:r}),(0,s.jsx)(l,{isDisabled:!o,onClick:t,text:"Send"})]})},c=e=>{let{message:t}=e;return(0,s.jsx)("div",{className:"flex w-max max-w-[75%] flex-col gap-2 rounded-lg px-3 py-2 text-sm bg-muted",children:t})};var a=n(4830),u=n(1609);let d={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},f=new Uint8Array(16),m=[];for(let e=0;e<256;++e)m.push((e+256).toString(16).slice(1));let p=function(e,t,n){if(d.randomUUID&&!t&&!e)return d.randomUUID();let s=(e=e||{}).random??e.rng?.()??function(){if(!r){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");r=crypto.getRandomValues.bind(crypto)}return r(f)}();if(s.length<16)throw Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((n=n||0)<0||n+16>t.length)throw RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=s[e];return t}return function(e,t=0){return(m[e[t+0]]+m[e[t+1]]+m[e[t+2]]+m[e[t+3]]+"-"+m[e[t+4]]+m[e[t+5]]+"-"+m[e[t+6]]+m[e[t+7]]+"-"+m[e[t+8]]+m[e[t+9]]+"-"+m[e[t+10]]+m[e[t+11]]+m[e[t+12]]+m[e[t+13]]+m[e[t+14]]+m[e[t+15]]).toLowerCase()}(s)},g=e=>{let[t,n]=(0,u.useState)(""),[r,s]=(0,u.useState)(!1),[o,l]=(0,u.useState)(!1),i=(0,u.useRef)(null),c=(0,u.useRef)(p()),a=(0,u.useRef)([]),d=(0,u.useRef)(0),f=(0,u.useCallback)(()=>{let t=new WebSocket(e);i.current=t,t.onopen=()=>{for(console.log("WebSocket connection opened for",c.current),s(!0),d.current=0,t.send(JSON.stringify({uuid:c.current,init:!0}));a.current.length>0;){let e=a.current.shift();e&&m(e)}},t.onmessage=e=>{try{let t=JSON.parse(e.data);console.log("Received from server:",t),t.on_chat_model_stream&&n(e=>e+t.on_chat_model_stream),t.on_chat_model_end&&l(!0)}catch(e){console.log("Error parsing WebSocket message:",e)}},t.onclose=()=>{console.log("WebSocket connection closed"),s(!1),d.current<5?(d.current+=1,console.log("Attempting to reconnect (".concat(d.current,"/").concat(5,") in 3 seconds...")),setTimeout(f,3e3)):console.log("Max reconnection attempts reached. Stopping reconnection.")},t.onerror=e=>{console.log("WebSocket error:",e)}},[e]);(0,u.useEffect)(()=>(f(),()=>{i.current&&i.current.readyState===WebSocket.OPEN&&i.current.close()}),[f]);let m=e=>{if(i.current&&i.current.readyState===WebSocket.OPEN){let t={uuid:c.current,message:e,init:!1};i.current.send(JSON.stringify(t)),l(!1),n("")}else console.log("WebSocket connection is not open, queuing message:",e),a.current.push(e)};return{response:t,isOpen:r,isBotResponseComplete:o,sendMessage:m}};function h(){let[e,t]=(0,u.useState)([]),[n,r]=(0,u.useState)(""),{response:l,isOpen:d,sendMessage:f}=g("ws://localhost:2999/ws/chat"),m=(0,u.useRef)(null);(0,u.useEffect)(()=>{l&&t(e=>{let t=e[e.length-1];return t&&"Bot"===t.user?(t.msg=l,[...e]):[...e,{user:"Bot",msg:l}]})},[l]);let p=()=>{if(n.trim()){let e={user:"User",msg:n};t(t=>[...t,e]),r(""),d&&f(n)}};return(0,u.useEffect)(()=>{let e=setTimeout(()=>{var e;null===(e=m.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})});return()=>clearTimeout(e)},[e]),(0,s.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},className:"flex w-full items-center justify-center",children:[(0,s.jsx)("div",{className:"w-full flex items-center justify-center",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-center",children:"Welcome! How can I be of service today?"})}),(0,s.jsx)("div",{className:"rounded-xl w-full border bg-card text-card-foreground shadow mt-5",style:{height:"60vh",display:"flex",flexDirection:"column",justifyContent:"flex-end"},children:(0,s.jsxs)("div",{className:"h-full",style:{display:"flex",width:"100%",flexDirection:"column",justifyContent:"space-between"},children:[(0,s.jsxs)("div",{className:"p-6 space-y-4 xl:space-y-4 h-full overflow-y-auto",children:[(0,s.jsx)("div",{className:"space-y-4",children:e.map(e=>"User"===e.user?(0,s.jsx)(c,{message:e.msg},e.msg):(0,s.jsx)(o,{message:e.msg},e.msg))}),(0,s.jsx)("div",{ref:m})]}),(0,s.jsx)(a.U,{className:"flex items-center p-6 pt-0 h-28",children:(0,s.jsx)(i,{onClick:p,handleChange:e=>{r(e.target.value)},handleKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),p())},input:n})})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[583,318,582,358],()=>t(7119)),_N_E=e.O()}]);